# M2: Performance (Core Web Vitals)

## OBJETIVO (OBJ)
Establecer un estándar de rendimiento de "Clase Mundial" desde el inicio, definiendo presupuestos (budgets) y estrategias de carga de recursos.

## ALCANCE (ALC)
- Configuración de `perf-budget`.
- Estrategia de fuentes y media.
- Control de third-parties.

## PASOS
1.  **Performance Budgets**:
    - Crear `.bundlesizeconfig` o similar (dependiendo del stack).
    - Definir límites:
        - JS Inicial (Gzip): < 100KB.
        - CSS Crítico: Inline o < 10KB.
        - Total Page Weight: < 1MB (optimista).
2.  **Estrategia de Fuentes**:
    - Estandarizar uso de `next/font` (en Next.js) o `@font-source` (en Vite) para self-hosting.
    - Prohibir Google Fonts vía CDN remoto (por privacidad y CLS).
3.  **Optimización de Imágenes (LCP)**:
    - Crear componente `Image` wrapper (si no se usa `next/image`) que fuerce `width/height` y genere skeletons.
    - Regla: La imagen de Hero siempre debe tener `priority` o `loading="eager"`.
4.  **Interaction to Next Paint (INP)**:
    - Revisar listeners de eventos globales.
    - Asegurar que no hay tareas largas (>50ms) en el main thread durante la hidratación.

## CRITERIOS DE ACEPTACIÓN (AC)
- [ ] Documento `docs/performance-budgets.md` creado con límites explícitos.
- [ ] Configuración base para fonts self-hosted implementada en el "núcleo compartido".
- [ ] Componente de Imagen optimizado disponible.

## EJECUCIÓN (EJ)
Validar con Lighthouse CI (previsto en M9, pero aquí se definen las reglas).

## RIESGOS
- Optimización prematura que complique la DX (Developer Experience).
- Conflictos con librerías de terceros (analytics, chat widgets) que rompan el budget.
